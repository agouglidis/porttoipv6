<?xml version="1.0"?>
<!-- Description of Microsoft Winsock rules -->
<rules>
	<rule>
		<CONDITION>WINSOCK_API,START_COMMENTS_AND_WINSOCK_API</CONDITION>
		<PATTERN>[^"LP"]"SOCKADDR_IN"[^6]</PATTERN>
		<TYPE>PF_STRUCTURE</TYPE>
		<COMMENT>Change SOCKADDR_IN to SOCKADDR_STORAGE, or SOCKADDR_IN6</COMMENT>
	</rule>
	<rule>
		<CONDITION>WINSOCK_API,START_COMMENTS_AND_WINSOCK_API</CONDITION>
		<PATTERN>"IP_ADAPTER_INFO"</PATTERN>
		<TYPE>PF_STRUCTURE</TYPE>
		<COMMENT>Use IP_ADAPTER_ADDRESS or IP_ADAPTER_ADDRESSES instead of IP_ADAPTER_INFO</COMMENT>
	</rule>
	<rule>
		<CONDITION>WINSOCK_API,START_COMMENTS_AND_WINSOCK_API</CONDITION>
		<PATTERN>"LPIN_ADDR"</PATTERN>
		<TYPE>PF_STRUCTURE</TYPE>
		<COMMENT>Change LPIN_ADDR to LPIN6_ADDR</COMMENT>
	</rule>
	<rule>
		<CONDITION>WINSOCK_API,START_COMMENTS_AND_WINSOCK_API</CONDITION>
		<PATTERN>"P"?"IN_ADDR"</PATTERN>
		<TYPE>PF_STRUCTURE</TYPE>
		<COMMENT>use PIN6_ADDR in addition for IPv6 support</COMMENT>
	</rule>
	<rule>
		<CONDITION>WINSOCK_API,START_COMMENTS_AND_WINSOCK_API</CONDITION>
		<PATTERN>"LPSOCKADDR_IN"[^6]</PATTERN>
		<TYPE>PF_STRUCTURE</TYPE>
		<COMMENT>Change LPSOCKADDR_IN to LPSOCKADDR_STORAGE, or LPSOCKADDR_IN6</COMMENT>
	</rule>
	<rule>
		<CONDITION>WINSOCK_API,START_COMMENTS_AND_WINSOCK_API</CONDITION>
		<PATTERN>"PSOCKADDR_IN"[^6]</PATTERN>
		<TYPE>PF_STRUCTURE</TYPE>
		<COMMENT>use PSOCKADDR_STORAGE instead, or use PSOCKADDR_IN6 in addition for IPv6 support</COMMENT>
	</rule>
	<rule>
		<CONDITION>WINSOCK_API,START_COMMENTS_AND_WINSOCK_API</CONDITION>
		<PATTERN>"LPHOSTENT"</PATTERN>
		<TYPE>PF_STRUCTURE</TYPE>
		<COMMENT>Change LPHOSTENT to LPADDRINFO</COMMENT>
	</rule>
	<rule>
		<CONDITION>WINSOCK_API,START_COMMENTS_AND_WINSOCK_API</CONDITION>
		<PATTERN>"inet_ntoa"</PATTERN>
		<TYPE>PF_FUNCTION</TYPE>
		<COMMENT>Use WSAAddressToString or getnameinfo with NI_NUMERICHOST instead of inet_ntoa</COMMENT>
	</rule>
	<rule>
		<CONDITION>WINSOCK_API,START_COMMENTS_AND_WINSOCK_API</CONDITION>
		<PATTERN>"inet_addr"</PATTERN>
		<TYPE>PF_FUNCTION</TYPE>
		<COMMENT>Use WSAStringToAddress or getaddrinfo with AI_NUMERICHOST instead of inet_addr</COMMENT>
	</rule>
	<rule>
		<CONDITION>WINSOCK_API,START_COMMENTS_AND_WINSOCK_API</CONDITION>
		<PATTERN>"winsock.h"</PATTERN>
		<TYPE>PF_HEADER_FILE</TYPE>
		<COMMENT>Winsock.h include file detected. Change to winsock2.h. Addition of ws2tcpip.h is also recommended.</COMMENT>
	</rule>
	<rule>
		<CONDITION>WINSOCK_API,START_COMMENTS_AND_WINSOCK_API</CONDITION>
		<PATTERN>"GetAdaptersInfo"</PATTERN>
		<TYPE>PF_FUNCTION</TYPE>
		<COMMENT>Use GetAdaptersAddresses instead of GetAdaptersInfo</COMMENT>
	</rule>
</rules>